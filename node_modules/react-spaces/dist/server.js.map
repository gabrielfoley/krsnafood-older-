{"version":3,"file":"server.js","sources":["../src/core-types.ts","../src/core-utils.ts","../src/core-resizing.ts","../src/core.ts","../src/core-react.ts","../src/components/Centered.tsx","../src/components/CenteredVertically.tsx","../src/components/Space.tsx","../src/components/Anchored.tsx","../src/components/Custom.tsx","../src/components/Fill.tsx","../src/components/Fixed.tsx","../src/components/Layer.tsx","../src/components/Positioned.tsx","../src/components/SpaceInfo.tsx","../src/components/ViewPort.tsx","../src/components/Options.tsx"],"sourcesContent":["export enum Type {\r\n\tViewPort = \"viewport\",\r\n\tFixed = \"fixed\",\r\n\tFill = \"fill\",\r\n\tPositioned = \"positioned\",\r\n\tAnchored = \"anchored\",\r\n\tCustom = \"custom\",\r\n}\r\n\r\nexport enum AnchorType {\r\n\tLeft = \"anchor-left\",\r\n\tRight = \"anchor-right\",\r\n\tTop = \"anchor-top\",\r\n\tBottom = \"anchor-bottom\",\r\n}\r\n\r\nexport enum Orientation {\r\n\tHorizontal,\r\n\tVertical,\r\n}\r\n\r\nexport type SizeUnit = number | string | undefined;\r\n\r\nexport enum ResizeType {\r\n\tLeft = \"resize-left\",\r\n\tRight = \"resize-right\",\r\n\tTop = \"resize-top\",\r\n\tBottom = \"resize-bottom\",\r\n\tNW = \"resize-nw\",\r\n\tNE = \"resize-ne\",\r\n\tSW = \"resize-sw\",\r\n\tSE = \"resize-se\",\r\n}\r\n\r\nexport enum ResizeHandlePlacement {\r\n\tOverlayInside = \"overlay-inside\",\r\n\tInside = \"inside\",\r\n\tOverlayBoundary = \"overlay-boundary\",\r\n}\r\n\r\nexport enum CenterType {\r\n\tNone = \"none\",\r\n\tVertical = \"vertical\",\r\n\tHorizontalVertical = \"horizontalVertical\",\r\n}\r\n\r\nexport interface IPassThroughEvents {\r\n\tonClick?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonDoubleClick?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseDown?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseEnter?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseLeave?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseMove?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonTouchStart?: (event: React.TouchEvent<HTMLElement>) => void;\r\n\tonTouchMove?: (event: React.TouchEvent<HTMLElement>) => void;\r\n\tonTouchEnd?: (event: React.TouchEvent<HTMLElement>) => void;\r\n}\r\n\r\nexport interface ICommonProps extends IPassThroughEvents {\r\n\tid?: string;\r\n\tclassName?: string;\r\n\tstyle?: React.CSSProperties;\r\n\tas?: string;\r\n\tcenterContent?: CenterType;\r\n\tzIndex?: number;\r\n\tscrollable?: boolean;\r\n\ttrackSize?: boolean;\r\n}\r\n\r\nexport interface ISpaceProps extends ICommonProps {\r\n\ttype: Type;\r\n\tanchor?: AnchorType | undefined;\r\n\torder?: number | undefined;\r\n\tposition?: IPositionalProps | undefined;\r\n\thandleSize?: number | undefined;\r\n\thandlePlacement?: ResizeHandlePlacement;\r\n\ttouchHandleSize?: number | undefined;\r\n\tminimumSize?: number | undefined;\r\n\tmaximumSize?: number | undefined;\r\n\tonResizeStart?: (() => void | boolean) | undefined;\r\n\tonResizeEnd?: ((newSize: SizeUnit, domRect: DOMRect) => void) | undefined;\r\n}\r\n\r\nexport interface ISpaceStore {\r\n\tgetSpaces: () => ISpaceDefinition[];\r\n\tgetSpace: (id: string) => ISpaceDefinition | undefined;\r\n\taddSpace: (space: ISpaceDefinition) => void;\r\n\tupdateSpace: (space: ISpaceDefinition, props: ISpaceProps) => void;\r\n\tupdateStyles: (space: ISpaceDefinition) => void;\r\n\tremoveSpace: (space: ISpaceDefinition) => void;\r\n\tcreateSpace: (parent: string | undefined, props: ISpaceProps, update: () => void) => ISpaceDefinition;\r\n\tstartMouseResize: (resizeType: ResizeType, space: ISpaceDefinition, size: ISize, event: React.MouseEvent<HTMLElement>) => void;\r\n\tstartTouchResize: (resizeType: ResizeType, space: ISpaceDefinition, size: ISize, event: React.TouchEvent<HTMLElement>) => void;\r\n}\r\n\r\nexport interface IPosition {\r\n\tleft?: SizeUnit | undefined;\r\n\ttop?: SizeUnit | undefined;\r\n\tright?: SizeUnit | undefined;\r\n\tbottom?: SizeUnit | undefined;\r\n\twidth?: SizeUnit | undefined;\r\n\theight?: SizeUnit | undefined;\r\n}\r\n\r\nexport interface IPositionalProps extends IPosition {\r\n\tleftResizable?: boolean;\r\n\ttopResizable?: boolean;\r\n\trightResizable?: boolean;\r\n\tbottomResizable?: boolean;\r\n}\r\n\r\nexport interface ISize {\r\n\tsize: SizeUnit;\r\n\tadjusted: SizeUnit[];\r\n\tresized: number;\r\n}\r\n\r\nexport interface ISpaceDefinition {\r\n\tupdate: () => void;\r\n\tupdateParent: () => void;\r\n\tadjustLeft: (adjusted: SizeUnit[]) => boolean;\r\n\tadjustRight: (adjusted: SizeUnit[]) => boolean;\r\n\tadjustTop: (adjusted: SizeUnit[]) => boolean;\r\n\tadjustBottom: (adjusted: SizeUnit[]) => boolean;\r\n\tadjustEdge: (adjusted: SizeUnit[]) => boolean;\r\n\tanchoredChildren: (children: ISpaceDefinition[], anchor: AnchorType, zIndex: number) => ISpaceDefinition[];\r\n\tonResizeStart?: (() => void | boolean) | undefined;\r\n\tonResizeEnd?: ((newSize: SizeUnit, domRect: DOMRect) => void) | undefined;\r\n\telement: HTMLElement;\r\n\tid: string;\r\n\ttype: Type;\r\n\tanchor?: AnchorType;\r\n\torientation: Orientation;\r\n\tscrollable: boolean;\r\n\torder?: number;\r\n\tposition: \"fixed\" | \"absolute\" | \"relative\";\r\n\tchildren: ISpaceDefinition[];\r\n\tparentId: string | undefined;\r\n\tstore: ISpaceStore;\r\n\tleft: ISize;\r\n\ttop: ISize;\r\n\tright: ISize;\r\n\tbottom: ISize;\r\n\twidth: ISize;\r\n\theight: ISize;\r\n\tzIndex: number;\r\n\tdimension: DOMRect;\r\n\tcenterContent: \"none\" | \"vertical\" | \"horizontalVertical\";\r\n\tresizing: boolean;\r\n\tminimumSize?: number;\r\n\tmaximumSize?: number;\r\n\thandleSize: number;\r\n\ttouchHandleSize: number;\r\n\thandlePlacement: ResizeHandlePlacement;\r\n\tcanResizeTop: boolean;\r\n\tcanResizeLeft: boolean;\r\n\tcanResizeRight: boolean;\r\n\tcanResizeBottom: boolean;\r\n}\r\n","import { ISpaceDefinition, SizeUnit, ISize, ResizeHandlePlacement } from \"./core-types\";\r\n\r\nexport function shortuuid() {\r\n\tlet firstPart = (Math.random() * 46656) | 0;\r\n\tlet secondPart = (Math.random() * 46656) | 0;\r\n\treturn (\"000\" + firstPart.toString(36)).slice(-3) + (\"000\" + secondPart.toString(36)).slice(-3);\r\n}\r\n\r\nexport function getSizeString(size: SizeUnit) {\r\n\treturn typeof size === \"string\" ? size : `${size}px`;\r\n}\r\n\r\nexport function css(size: ISize, dontAddCalc?: boolean) {\r\n\tif (size.size === 0 && size.adjusted.length === 0 && size.resized === 0) {\r\n\t\treturn `0px`;\r\n\t}\r\n\r\n\tconst parts: string[] = [];\r\n\tif (size.size !== undefined) {\r\n\t\tparts.push(getSizeString(size.size));\r\n\t}\r\n\r\n\tsize.adjusted.forEach((l) => parts.push(getSizeString(l)));\r\n\r\n\tif (size.resized !== 0) {\r\n\t\tparts.push(getSizeString(size.resized));\r\n\t}\r\n\r\n\tif (parts.length === 0) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tif (parts.length === 1) {\r\n\t\treturn parts[0];\r\n\t}\r\n\r\n\tif (dontAddCalc) {\r\n\t\treturn parts.join(\" + \");\r\n\t}\r\n\r\n\treturn `calc(${parts.join(\" + \")})`;\r\n}\r\n\r\nexport function coalesce<T>(...args: T[]) {\r\n\treturn args.find((x) => x !== null && x !== undefined);\r\n}\r\n\r\nexport function adjustmentsEqual(item1: SizeUnit[], item2: SizeUnit[]) {\r\n\tif (item1.length !== item2.length) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfor (var i = 0, len = item1.length; i < len; i++) {\r\n\t\tif (item1[i] !== item2[i]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nexport function throttle<F extends (...args: any) => any>(callback: F, limit: number) {\r\n\tvar wait = false; // Initially, we're not waiting\r\n\treturn function(...args: any) {\r\n\t\t// We return a throttled function\r\n\t\tif (!wait) {\r\n\t\t\t// If we're not waiting\r\n\t\t\tcallback(...args); // Execute users function\r\n\t\t\twait = true; // Prevent future invocations\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\t// After a period of time\r\n\t\t\t\twait = false; // And allow future invocations\r\n\t\t\t}, limit);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport function styleDefinition(space: ISpaceDefinition) {\r\n\tconst cssElements: string[] = [];\r\n\r\n\tconst style: React.CSSProperties = {\r\n\t\tposition: space.position,\r\n\t\tleft: css(space.left),\r\n\t\ttop: css(space.top),\r\n\t\tright: css(space.right),\r\n\t\tbottom: css(space.bottom),\r\n\t\twidth: css(space.width),\r\n\t\theight: css(space.height),\r\n\t\tzIndex: space.zIndex,\r\n\t};\r\n\r\n\tconst cssString: string[] = [];\r\n\r\n\tif (style.position) {\r\n\t\tcssString.push(`position: ${style.position};`);\r\n\t}\r\n\tif (style.left) {\r\n\t\tcssString.push(`left: ${style.left};`);\r\n\t}\r\n\tif (style.top) {\r\n\t\tcssString.push(`top: ${style.top};`);\r\n\t}\r\n\tif (style.right) {\r\n\t\tcssString.push(`right: ${style.right};`);\r\n\t}\r\n\tif (style.bottom) {\r\n\t\tcssString.push(`bottom: ${style.bottom};`);\r\n\t}\r\n\tif (style.width) {\r\n\t\tcssString.push(`width: ${style.width};`);\r\n\t}\r\n\tif (style.height) {\r\n\t\tcssString.push(`height: ${style.height};`);\r\n\t}\r\n\tif (style.zIndex) {\r\n\t\tcssString.push(`z-index: ${style.zIndex};`);\r\n\t}\r\n\r\n\tif (cssString.length > 0) {\r\n\t\tcssElements.push(`#${space.id} { ${cssString.join(\" \")} }`);\r\n\t}\r\n\r\n\tif (space.scrollable) {\r\n\t\tcssElements.push(`#${space.id} > .spaces-space-inner { overflow: auto; touch-action: auto; }`);\r\n\t}\r\n\r\n\tlet handleOffset = 0;\r\n\tconst touchHandleSize = space.touchHandleSize / 2 - space.handleSize / 2;\r\n\r\n\tswitch (space.handlePlacement) {\r\n\t\tcase ResizeHandlePlacement.Inside:\r\n\t\tcase ResizeHandlePlacement.OverlayInside:\r\n\t\t\thandleOffset = space.handleSize;\r\n\t\t\tbreak;\r\n\t\tcase ResizeHandlePlacement.OverlayBoundary:\r\n\t\t\thandleOffset = space.handleSize / 2;\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tif (space.canResizeLeft) {\r\n\t\tcssElements.push(\r\n\t\t\t`#${space.id}-m { left: calc(${css(space.left, true)} + ${css(space.width, true)} - ${handleOffset}px); width: ${space.handleSize}px; }`,\r\n\t\t);\r\n\t\tcssElements.push(`#${space.id}-m:after { left: -${touchHandleSize}px; right: -${touchHandleSize}px; top: 0; bottom: 0; }`);\r\n\t}\r\n\r\n\tif (space.canResizeTop) {\r\n\t\tcssElements.push(\r\n\t\t\t`#${space.id}-m { top: calc(${css(space.top, true)} + ${css(space.height, true)} - ${handleOffset}px); height: ${space.handleSize}px; }`,\r\n\t\t);\r\n\t\tcssElements.push(`#${space.id}-m:after { top: -${touchHandleSize}px; bottom: -${touchHandleSize}px; left: 0; right: 0; }`);\r\n\t}\r\n\r\n\tif (space.canResizeRight) {\r\n\t\tcssElements.push(\r\n\t\t\t`#${space.id}-m { right: calc(${css(space.right, true)} + ${css(space.width, true)} - ${handleOffset}px); width: ${\r\n\t\t\t\tspace.handleSize\r\n\t\t\t}px; }`,\r\n\t\t);\r\n\t\tcssElements.push(`#${space.id}-m:after { left: -${touchHandleSize}px; right: -${touchHandleSize}px; top: 0; bottom: 0; }`);\r\n\t}\r\n\r\n\tif (space.canResizeBottom) {\r\n\t\tcssElements.push(\r\n\t\t\t`#${space.id}-m { bottom: calc(${css(space.bottom, true)} + ${css(space.height, true)} - ${handleOffset}px); height: ${\r\n\t\t\t\tspace.handleSize\r\n\t\t\t}px; }`,\r\n\t\t);\r\n\t\tcssElements.push(`#${space.id}-m:after { top: -${touchHandleSize}px; bottom: -${touchHandleSize}px; left: 0; right: 0; }`);\r\n\t}\r\n\r\n\treturn cssElements.join(\" \");\r\n}\r\n\r\nexport function updateStyleDefinition(space: ISpaceDefinition) {\r\n\tconst definition = styleDefinition(space);\r\n\tconst existing = document.getElementById(`style_${space.id}`);\r\n\r\n\tif (existing) {\r\n\t\tif (existing.innerHTML !== definition) {\r\n\t\t\texisting.innerHTML = definition;\r\n\t\t}\r\n\t} else {\r\n\t\tconst newStyle = document.createElement(\"style\");\r\n\t\tnewStyle.id = `style_${space.id}`;\r\n\t\tnewStyle.innerHTML = definition;\r\n\t\tdocument.head.appendChild(newStyle);\r\n\t}\r\n}\r\n\r\nexport function removeStyleDefinition(space: ISpaceDefinition) {\r\n\tconst existing = document.getElementById(`style_${space.id}`);\r\n\tif (existing) {\r\n\t\tdocument.head.removeChild(existing);\r\n\t}\r\n}\r\n","import { SyntheticEvent } from \"react\";\r\nimport { ISpaceDefinition, ISize, ResizeType, Orientation, ISpaceStore } from \"./core-types\";\r\nimport { throttle, coalesce } from \"./core-utils\";\r\n\r\nconst RESIZE_THROTTLE = 0;\r\n\r\nexport enum MoveEvent {\r\n\tMouse = \"mousemove\",\r\n\tTouch = \"touchmove\",\r\n}\r\n\r\nexport enum EndEvent {\r\n\tMouse = \"mouseup\",\r\n\tTouch = \"touchend\",\r\n}\r\n\r\nexport interface IResizeChange {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nexport function createResize(store: ISpaceStore) {\r\n\tfunction onResize(\r\n\t\tspace: ISpaceDefinition,\r\n\t\ttargetSize: ISize,\r\n\t\tresizeType: ResizeType,\r\n\t\tstartSize: number,\r\n\t\toriginalX: number,\r\n\t\toriginalY: number,\r\n\t\tx: number,\r\n\t\ty: number,\r\n\t\tminimumAdjust: number,\r\n\t\tmaximumAdjust: number | undefined,\r\n\t) {\r\n\t\tlet adjustment =\r\n\t\t\tstartSize +\r\n\t\t\t(space.orientation === Orientation.Horizontal\r\n\t\t\t\t? resizeType === ResizeType.Left\r\n\t\t\t\t\t? originalX - x\r\n\t\t\t\t\t: x - originalX\r\n\t\t\t\t: resizeType === ResizeType.Top\r\n\t\t\t\t? originalY - y\r\n\t\t\t\t: y - originalY);\r\n\r\n\t\tif (adjustment < minimumAdjust) {\r\n\t\t\tadjustment = minimumAdjust;\r\n\t\t} else {\r\n\t\t\tif (maximumAdjust) {\r\n\t\t\t\tif (adjustment > maximumAdjust) {\r\n\t\t\t\t\tadjustment = maximumAdjust;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (adjustment !== targetSize.resized) {\r\n\t\t\ttargetSize.resized = adjustment;\r\n\t\t\tstore.updateStyles(space);\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tstartResize<T extends SyntheticEvent<HTMLElement> | MouseEvent | TouchEvent>(\r\n\t\t\tresizeType: ResizeType,\r\n\t\t\te: T,\r\n\t\t\tspace: ISpaceDefinition,\r\n\t\t\ttargetSize: ISize,\r\n\t\t\tendEvent: EndEvent,\r\n\t\t\tmoveEvent: MoveEvent,\r\n\t\t\tgetCoords: (event: T) => { x: number; y: number },\r\n\t\t) {\r\n\t\t\tif (space.onResizeStart) {\r\n\t\t\t\tconst result = space.onResizeStart();\r\n\t\t\t\tif (typeof result === \"boolean\" && !result) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst originalCoords = getCoords(e);\r\n\r\n\t\t\tspace.resizing = true;\r\n\t\t\tspace.updateParent();\r\n\r\n\t\t\tconst rect = space.element.getBoundingClientRect();\r\n\t\t\tconst size = space.orientation === Orientation.Horizontal ? rect.width : rect.height;\r\n\t\t\tconst startSize = targetSize.resized;\r\n\t\t\tconst minimumAdjust = coalesce(space.minimumSize, 20)! - size + targetSize.resized;\r\n\t\t\tconst maximumAdjust = space.maximumSize ? space.maximumSize - size + targetSize.resized : undefined;\r\n\r\n\t\t\tlet lastX = 0;\r\n\t\t\tlet lastY = 0;\r\n\t\t\tlet moved = false;\r\n\r\n\t\t\tconst resize = (x: number, y: number) =>\r\n\t\t\t\tonResize(space, targetSize, resizeType, startSize, originalCoords.x, originalCoords.y, x, y, minimumAdjust, maximumAdjust);\r\n\r\n\t\t\tconst withPreventDefault = (e: T) => {\r\n\t\t\t\tmoved = true;\r\n\t\t\t\tconst newCoords = getCoords(e);\r\n\t\t\t\tlastX = newCoords.x;\r\n\t\t\t\tlastY = newCoords.y;\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tthrottle((x, y) => window.requestAnimationFrame(() => resize(x, y)), RESIZE_THROTTLE)(lastX, lastY);\r\n\t\t\t};\r\n\r\n\t\t\tconst removeListener = () => {\r\n\t\t\t\tif (moved) {\r\n\t\t\t\t\tresize(lastX, lastY);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// if (elementsUnderneathPointer && elementsUnderneathPointer.length > 1) {\r\n\t\t\t\t\t// \tconst target = elementsUnderneathPointer[1] as any;\r\n\t\t\t\t\t// \ttarget.submitMessage(e);\r\n\t\t\t\t\t// }\r\n\t\t\t\t}\r\n\t\t\t\twindow.removeEventListener(moveEvent, withPreventDefault as EventListener);\r\n\t\t\t\twindow.removeEventListener(endEvent, removeListener);\r\n\r\n\t\t\t\tspace.resizing = false;\r\n\t\t\t\tspace.updateParent();\r\n\r\n\t\t\t\tif (space.onResizeEnd) {\r\n\t\t\t\t\tconst currentRect = space.element.getBoundingClientRect();\r\n\t\t\t\t\tspace.onResizeEnd(\r\n\t\t\t\t\t\tMath.floor(resizeType === ResizeType.Left || resizeType === ResizeType.Right ? currentRect.width : currentRect.height),\r\n\t\t\t\t\t\tcurrentRect as DOMRect,\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\twindow.addEventListener(moveEvent, withPreventDefault as EventListener);\r\n\t\t\twindow.addEventListener(endEvent, removeListener);\r\n\t\t\t//e.preventDefault();\r\n\t\t},\r\n\t};\r\n}\r\n","import { ISpaceDefinition, SizeUnit, AnchorType, Type, Orientation, ISpaceStore, ISpaceProps, CenterType, ResizeHandlePlacement } from \"./core-types\";\r\nimport { EndEvent, MoveEvent, createResize } from \"./core-resizing\";\r\nimport { updateStyleDefinition, removeStyleDefinition, coalesce, adjustmentsEqual } from \"./core-utils\";\r\n\r\nconst spaceDefaults: Partial<ISpaceDefinition> = {\r\n\tid: \"\",\r\n\tzIndex: 0,\r\n\tscrollable: false,\r\n\tresizing: false,\r\n\tcenterContent: \"none\",\r\n\tdimension: { left: 0, top: 0, right: 0, bottom: 0, width: 0, height: 0, x: 0, y: 0, toJSON: () => \"\" },\r\n\thandleSize: 5,\r\n\ttouchHandleSize: 5,\r\n\thandlePlacement: ResizeHandlePlacement.OverlayInside,\r\n\tadjustLeft: () => false,\r\n\tadjustRight: () => false,\r\n\tadjustTop: () => false,\r\n\tadjustBottom: () => false,\r\n\tadjustEdge: () => false,\r\n\tanchoredChildren: () => [],\r\n};\r\n\r\nconst anchorTypes = [AnchorType.Left, AnchorType.Top, AnchorType.Right, AnchorType.Bottom];\r\n\r\nfunction getPosition(type: Type) {\r\n\tif (type === Type.ViewPort) {\r\n\t\treturn \"fixed\";\r\n\t}\r\n\tif (type === Type.Fixed) {\r\n\t\treturn \"relative\";\r\n\t}\r\n\treturn \"absolute\";\r\n}\r\n\r\nfunction getOrientation(anchor: AnchorType | undefined) {\r\n\treturn anchor === AnchorType.Bottom || anchor === AnchorType.Top ? Orientation.Vertical : Orientation.Horizontal;\r\n}\r\n\r\nfunction anchorUpdates(space: ISpaceDefinition) {\r\n\treturn [\r\n\t\t{\r\n\t\t\tanchor: AnchorType.Left,\r\n\t\t\tupdate: space.adjustLeft,\r\n\t\t},\r\n\t\t{\r\n\t\t\tanchor: AnchorType.Top,\r\n\t\t\tupdate: space.adjustTop,\r\n\t\t},\r\n\t\t{\r\n\t\t\tanchor: AnchorType.Right,\r\n\t\t\tupdate: space.adjustRight,\r\n\t\t},\r\n\t\t{\r\n\t\t\tanchor: AnchorType.Bottom,\r\n\t\t\tupdate: space.adjustBottom,\r\n\t\t},\r\n\t];\r\n}\r\n\r\nfunction sizeInfoDefault(size: SizeUnit) {\r\n\treturn { size: size, adjusted: [], resized: 0 };\r\n}\r\n\r\nexport function createStore(): ISpaceStore {\r\n\tlet spaces: ISpaceDefinition[] = [];\r\n\r\n\tconst setSpaces = (newSpaces: ISpaceDefinition[]) => {\r\n\t\tspaces = newSpaces;\r\n\t};\r\n\r\n\tconst getSpace = (id: string) => {\r\n\t\treturn getSpaces().find((s) => s.id === id);\r\n\t};\r\n\r\n\tconst getSpaces = () => spaces;\r\n\r\n\tconst recalcSpaces = (parent: ISpaceDefinition) => {\r\n\t\tconst onlyUnique = (value: number, index: number, self: number[]) => {\r\n\t\t\treturn self.indexOf(value) === index;\r\n\t\t};\r\n\r\n\t\tconst addDefaultOrders = (spaces: ISpaceDefinition[]) => {\r\n\t\t\tlet result: ISpaceDefinition[] = [];\r\n\r\n\t\t\tanchorTypes.forEach((t) => {\r\n\t\t\t\tconst anchoredSpaces = spaces.filter((s) => s.anchor !== undefined && s.anchor === t);\r\n\t\t\t\tconst zIndices = anchoredSpaces.map((s) => s.zIndex).filter(onlyUnique);\r\n\t\t\t\tzIndices.forEach((i) => {\r\n\t\t\t\t\tconst anchoredSpacesInLayer = anchoredSpaces.filter((s) => s.zIndex === i);\r\n\t\t\t\t\tconst orderedSpaces = anchoredSpacesInLayer.filter((c) => c.order !== undefined);\r\n\t\t\t\t\tconst unorderedSpaces = anchoredSpacesInLayer.filter((c) => c.order === undefined);\r\n\t\t\t\t\tvar maxOrder = orderedSpaces.length > 0 ? orderedSpaces.map((a) => a.order!).reduce((a, b) => Math.max(a, b)) : 0;\r\n\t\t\t\t\tresult = [...result, ...[...orderedSpaces, ...unorderedSpaces.map((c, idx) => ({ ...c, ...{ order: maxOrder + idx + 1 } }))]];\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\treturn [...result, ...spaces.filter((s) => s.anchor === undefined)];\r\n\t\t};\r\n\r\n\t\tconst orderedSpaces = addDefaultOrders(parent.children);\r\n\t\tfor (var i = 0, len = orderedSpaces.length; i < len; i++) {\r\n\t\t\tconst space = orderedSpaces[i];\r\n\t\t\tlet changed = false;\r\n\r\n\t\t\tif (space.type === Type.Fill) {\r\n\t\t\t\tanchorUpdates(space).forEach((info) => {\r\n\t\t\t\t\tconst adjusted: SizeUnit[] = [];\r\n\t\t\t\t\tconst anchoredSpaces = parent.anchoredChildren(orderedSpaces, info.anchor, space.zIndex);\r\n\r\n\t\t\t\t\tanchoredSpaces.forEach((as) => {\r\n\t\t\t\t\t\tif (as.orientation === Orientation.Vertical) {\r\n\t\t\t\t\t\t\tif (as.height.size) {\r\n\t\t\t\t\t\t\t\tadjusted.push(as.height.size);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (as.height.resized) {\r\n\t\t\t\t\t\t\t\tadjusted.push(as.height.resized);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (as.width.size) {\r\n\t\t\t\t\t\t\t\tadjusted.push(as.width.size);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (as.width.resized) {\r\n\t\t\t\t\t\t\t\tadjusted.push(as.width.resized);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (info.update(adjusted)) {\r\n\t\t\t\t\t\tchanged = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (space.type === Type.Anchored) {\r\n\t\t\t\tconst adjusted: SizeUnit[] = [];\r\n\t\t\t\tconst anchoredSpaces = parent\r\n\t\t\t\t\t.anchoredChildren(orderedSpaces, space.anchor!, space.zIndex)\r\n\t\t\t\t\t.filter((s) => s.id !== space.id && s.order! <= space.order!);\r\n\r\n\t\t\t\tanchoredSpaces.forEach((as) => {\r\n\t\t\t\t\tif (as.orientation === Orientation.Vertical) {\r\n\t\t\t\t\t\tif (as.height.size) {\r\n\t\t\t\t\t\t\tadjusted.push(as.height.size);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (as.height.resized) {\r\n\t\t\t\t\t\t\tadjusted.push(as.height.resized);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (as.width.size) {\r\n\t\t\t\t\t\t\tadjusted.push(as.width.size);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (as.width.resized) {\r\n\t\t\t\t\t\t\tadjusted.push(as.width.resized);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (space.adjustEdge(adjusted)) {\r\n\t\t\t\t\tchanged = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (changed) {\r\n\t\t\t\tupdateStyleDefinition(space);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst store: ISpaceStore = {\r\n\t\tgetSpaces: getSpaces,\r\n\t\tgetSpace: getSpace,\r\n\t\taddSpace: (space) => {\r\n\t\t\tgetSpaces().push(space);\r\n\r\n\t\t\tif (space.parentId) {\r\n\t\t\t\tconst parentSpace = getSpace(space.parentId);\r\n\t\t\t\tif (parentSpace) {\r\n\t\t\t\t\tparentSpace.children.push(space);\r\n\t\t\t\t\trecalcSpaces(parentSpace);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tupdateStyleDefinition(space);\r\n\t\t},\r\n\t\tremoveSpace: (space) => {\r\n\t\t\tsetSpaces(getSpaces().filter((s) => s.id !== space.id));\r\n\r\n\t\t\tif (space.parentId) {\r\n\t\t\t\tconst parentSpace = getSpace(space.parentId);\r\n\t\t\t\tif (parentSpace) {\r\n\t\t\t\t\tparentSpace.children = parentSpace.children.filter((s) => s.id !== space.id);\r\n\t\t\t\t\trecalcSpaces(parentSpace);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tremoveStyleDefinition(space);\r\n\t\t},\r\n\t\tupdateStyles: (space) => {\r\n\t\t\tif (space.parentId) {\r\n\t\t\t\tconst parent = getSpace(space.parentId);\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\trecalcSpaces(parent);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tupdateStyleDefinition(space);\r\n\t\t},\r\n\t\tupdateSpace: (space, props) => {\r\n\t\t\tconst {\r\n\t\t\t\ttype,\r\n\t\t\t\tanchor,\r\n\t\t\t\torder,\r\n\t\t\t\tzIndex,\r\n\t\t\t\tscrollable,\r\n\t\t\t\tposition,\r\n\t\t\t\tcenterContent,\r\n\t\t\t\tminimumSize,\r\n\t\t\t\tmaximumSize,\r\n\t\t\t\thandleSize,\r\n\t\t\t\ttouchHandleSize,\r\n\t\t\t\thandlePlacement,\r\n\t\t\t} = props;\r\n\t\t\tconst canResizeLeft = (position && position.rightResizable) || false;\r\n\t\t\tconst canResizeRight = (position && position.leftResizable) || false;\r\n\t\t\tconst canResizeTop = (position && position.bottomResizable) || false;\r\n\t\t\tconst canResizeBottom = (position && position.topResizable) || false;\r\n\r\n\t\t\tlet changed = false;\r\n\r\n\t\t\tif (space.type !== type) {\r\n\t\t\t\tspace.type = type;\r\n\t\t\t\tspace.position = getPosition(type);\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.anchor !== anchor) {\r\n\t\t\t\tspace.anchor = anchor;\r\n\t\t\t\tspace.orientation = getOrientation(anchor);\r\n\t\t\t\tchanged = true;\r\n\r\n\t\t\t\tif (type === Type.Anchored) {\r\n\t\t\t\t\tif (anchor === AnchorType.Left) {\r\n\t\t\t\t\t\tspace.adjustEdge = space.adjustLeft;\r\n\t\t\t\t\t} else if (anchor === AnchorType.Top) {\r\n\t\t\t\t\t\tspace.adjustEdge = space.adjustTop;\r\n\t\t\t\t\t} else if (anchor === AnchorType.Right) {\r\n\t\t\t\t\t\tspace.adjustEdge = space.adjustRight;\r\n\t\t\t\t\t} else if (anchor === AnchorType.Bottom) {\r\n\t\t\t\t\t\tspace.adjustEdge = space.adjustBottom;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (space.left.size !== (position && position.left)) {\r\n\t\t\t\tspace.left.size = position && position.left;\r\n\t\t\t\tspace.left.resized = 0;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.right.size !== (position && position.right)) {\r\n\t\t\t\tspace.right.size = position && position.right;\r\n\t\t\t\tspace.right.resized = 0;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.top.size !== (position && position.top)) {\r\n\t\t\t\tspace.top.size = position && position.top;\r\n\t\t\t\tspace.top.resized = 0;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.bottom.size !== (position && position.bottom)) {\r\n\t\t\t\tspace.bottom.size = position && position.bottom;\r\n\t\t\t\tspace.bottom.resized = 0;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.width.size !== (position && position.width)) {\r\n\t\t\t\tspace.width.size = position && position.width;\r\n\t\t\t\tspace.width.resized = 0;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.height.size !== (position && position.height)) {\r\n\t\t\t\tspace.height.size = position && position.height;\r\n\t\t\t\tspace.height.resized = 0;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (coalesce(space.order, 0) !== coalesce(order, 0)) {\r\n\t\t\t\tspace.order = coalesce(order, 0)!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (coalesce(space.zIndex, 0) !== coalesce(zIndex, 0)) {\r\n\t\t\t\tspace.zIndex = coalesce(zIndex, 0)!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (coalesce(space.scrollable, false) !== coalesce(scrollable, false)) {\r\n\t\t\t\tspace.scrollable = coalesce(scrollable, false)!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.minimumSize !== minimumSize) {\r\n\t\t\t\tspace.minimumSize = minimumSize;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.maximumSize !== maximumSize) {\r\n\t\t\t\tspace.maximumSize = maximumSize;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (coalesce(space.centerContent, CenterType.None) !== coalesce(centerContent, CenterType.None)) {\r\n\t\t\t\tspace.centerContent = coalesce(centerContent, CenterType.None)!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.handleSize !== handleSize) {\r\n\t\t\t\tspace.handleSize = handleSize || spaceDefaults.handleSize!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.touchHandleSize !== touchHandleSize) {\r\n\t\t\t\tspace.touchHandleSize = touchHandleSize || spaceDefaults.touchHandleSize!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.handlePlacement !== handlePlacement) {\r\n\t\t\t\tspace.handlePlacement = handlePlacement || spaceDefaults.handlePlacement!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeBottom !== canResizeBottom) {\r\n\t\t\t\tspace.canResizeBottom = canResizeBottom;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeTop !== canResizeTop) {\r\n\t\t\t\tspace.canResizeTop = canResizeTop;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeLeft !== canResizeLeft) {\r\n\t\t\t\tspace.canResizeLeft = canResizeLeft;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeRight !== canResizeRight) {\r\n\t\t\t\tspace.canResizeRight = canResizeRight;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (changed) {\r\n\t\t\t\tif (space.parentId) {\r\n\t\t\t\t\tconst parentSpace = getSpace(space.parentId);\r\n\t\t\t\t\tif (parentSpace) {\r\n\t\t\t\t\t\trecalcSpaces(parentSpace);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tupdateStyleDefinition(space);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreateSpace: () => ({} as ISpaceDefinition),\r\n\t\tstartMouseResize: () => null,\r\n\t\tstartTouchResize: () => null,\r\n\t};\r\n\r\n\tconst resize = createResize(store);\r\n\r\n\tstore.createSpace = (parentId: string | undefined, props: ISpaceProps, update: () => void) => {\r\n\t\tconst { position, anchor, type, ...commonProps } = props;\r\n\t\tconst canResizeLeft = (position && position.rightResizable) || false;\r\n\t\tconst canResizeRight = (position && position.leftResizable) || false;\r\n\t\tconst canResizeTop = (position && position.bottomResizable) || false;\r\n\t\tconst canResizeBottom = (position && position.topResizable) || false;\r\n\r\n\t\tconst newSpace: ISpaceDefinition = {\r\n\t\t\t...spaceDefaults,\r\n\t\t\t...commonProps,\r\n\t\t\t...{\r\n\t\t\t\tstore: store,\r\n\t\t\t\tupdate: update,\r\n\t\t\t\tupdateParent: () => {\r\n\t\t\t\t\tif (parentId) {\r\n\t\t\t\t\t\tconst parentSpace = store.getSpace(parentId);\r\n\t\t\t\t\t\tif (parentSpace) {\r\n\t\t\t\t\t\t\tparentSpace.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tparentId: parentId,\r\n\t\t\t\tchildren: [],\r\n\t\t\t\tanchor: anchor,\r\n\t\t\t\ttype: type,\r\n\t\t\t\torientation: getOrientation(anchor),\r\n\t\t\t\tposition: getPosition(type),\r\n\t\t\t\tleft: sizeInfoDefault(position && position.left),\r\n\t\t\t\tright: sizeInfoDefault(position && position.right),\r\n\t\t\t\ttop: sizeInfoDefault(position && position.top),\r\n\t\t\t\tbottom: sizeInfoDefault(position && position.bottom),\r\n\t\t\t\twidth: sizeInfoDefault(position && position.width),\r\n\t\t\t\theight: sizeInfoDefault(position && position.height),\r\n\t\t\t\tcanResizeLeft: canResizeLeft,\r\n\t\t\t\tcanResizeRight: canResizeRight,\r\n\t\t\t\tcanResizeTop: canResizeTop,\r\n\t\t\t\tcanResizeBottom: canResizeBottom,\r\n\t\t\t},\r\n\t\t} as ISpaceDefinition;\r\n\r\n\t\tnewSpace.anchoredChildren = (children, anchor, zIndex) => {\r\n\t\t\treturn children.filter((s) => s.type === Type.Anchored && s.anchor === anchor && s.zIndex === zIndex);\r\n\t\t};\r\n\r\n\t\tnewSpace.adjustLeft = (adjusted) => {\r\n\t\t\tif (adjustmentsEqual(newSpace.left.adjusted, adjusted)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tnewSpace.left.adjusted = adjusted;\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tnewSpace.adjustRight = (adjusted) => {\r\n\t\t\tif (adjustmentsEqual(newSpace.right.adjusted, adjusted)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tnewSpace.right.adjusted = adjusted;\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tnewSpace.adjustTop = (adjusted) => {\r\n\t\t\tif (adjustmentsEqual(newSpace.top.adjusted, adjusted)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tnewSpace.top.adjusted = adjusted;\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tnewSpace.adjustBottom = (adjusted) => {\r\n\t\t\tif (adjustmentsEqual(newSpace.bottom.adjusted, adjusted)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tnewSpace.bottom.adjusted = adjusted;\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tif (type === Type.Anchored) {\r\n\t\t\tif (anchor === AnchorType.Left) {\r\n\t\t\t\tnewSpace.adjustEdge = newSpace.adjustLeft;\r\n\t\t\t} else if (anchor === AnchorType.Top) {\r\n\t\t\t\tnewSpace.adjustEdge = newSpace.adjustTop;\r\n\t\t\t} else if (anchor === AnchorType.Right) {\r\n\t\t\t\tnewSpace.adjustEdge = newSpace.adjustRight;\r\n\t\t\t} else if (anchor === AnchorType.Bottom) {\r\n\t\t\t\tnewSpace.adjustEdge = newSpace.adjustBottom;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newSpace;\r\n\t};\r\n\r\n\tstore.startMouseResize = (resizeType, space, size, event) => {\r\n\t\tresize.startResize(resizeType, event, space, size, EndEvent.Mouse, MoveEvent.Mouse, (e) => ({\r\n\t\t\tx: e.clientX,\r\n\t\t\ty: e.clientY,\r\n\t\t}));\r\n\t};\r\n\r\n\tstore.startTouchResize = (resizeType, space, size, event) => {\r\n\t\tresize.startResize(resizeType, event, space, size, EndEvent.Touch, MoveEvent.Touch, (e) => ({\r\n\t\t\tx: e.touches[0].clientX,\r\n\t\t\ty: e.touches[0].clientY,\r\n\t\t}));\r\n\t};\r\n\r\n\treturn store;\r\n}\r\n","import * as React from \"react\";\r\nimport { createStore } from \"./core\";\r\nimport { ISpaceProps, ISpaceStore, ISpaceDefinition, IPositionalProps, ResizeType, CenterType } from \"./core-types\";\r\nimport { coalesce, shortuuid } from \"./core-utils\";\r\nimport { ResizeSensor } from \"css-element-queries\";\r\nimport * as PropTypes from \"prop-types\";\r\n\r\nexport const ParentContext = React.createContext<string | undefined>(undefined);\r\nexport const DOMRectContext = React.createContext<DOMRect | undefined>(undefined);\r\nexport const LayerContext = React.createContext<number | undefined>(undefined);\r\nexport const OptionsContext = React.createContext<IReactSpacesOptions>({});\r\nexport const currentStore = createStore();\r\n\r\nexport const commonProps = {\r\n\tid: PropTypes.string,\r\n\tclassName: PropTypes.string,\r\n\tstyle: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\r\n\tas: PropTypes.string,\r\n\tcenterContent: PropTypes.oneOf([CenterType.None, CenterType.Vertical, CenterType.HorizontalVertical]),\r\n\tzIndex: PropTypes.number,\r\n\tscrollable: PropTypes.bool,\r\n\ttrackSize: PropTypes.bool,\r\n\tonClick: PropTypes.func,\r\n\tonMouseDown: PropTypes.func,\r\n\tonMouseEnter: PropTypes.func,\r\n\tonMouseLeave: PropTypes.func,\r\n\tonMouseMove: PropTypes.func,\r\n\tonTouchStart: PropTypes.func,\r\n\tonTouchMove: PropTypes.func,\r\n\tonTouchEnd: PropTypes.func,\r\n};\r\n\r\nexport interface IReactSpacesOptions {\r\n\tdebug?: boolean\r\n}\r\n\r\nexport interface IReactEvents {\r\n\tonClick?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonDoubleClick?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseDown?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseEnter?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseLeave?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseMove?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonTouchStart?: (event: React.TouchEvent<HTMLElement>) => void;\r\n\tonTouchMove?: (event: React.TouchEvent<HTMLElement>) => void;\r\n\tonTouchEnd?: (event: React.TouchEvent<HTMLElement>) => void;\r\n}\r\n\r\nexport function useForceUpdate() {\r\n\tconst [, setTick] = React.useState(0);\r\n\tconst update = React.useCallback(() => {\r\n\t\tsetTick((tick) => tick + 1);\r\n\t}, []);\r\n\treturn update;\r\n}\r\n\r\nexport function useSpace(props: ISpaceProps) {\r\n\tconst store = currentStore;\r\n\tconst update = useForceUpdate();\r\n\tconst parent = React.useContext(ParentContext);\r\n\tconst layer = React.useContext(LayerContext);\r\n\tconst { debug } = React.useContext(OptionsContext);\r\n\tconst [spaceId] = React.useState(props.id || `s${shortuuid()}`);\r\n\tconst elementRef = React.useRef<HTMLElement>();\r\n\tconst resizeSensor = React.useRef<ResizeSensor>();\r\n\tconst [domRect, setDomRect] = React.useState<DOMRect>();\r\n\r\n\tlet space = store.getSpace(spaceId)!;\r\n\r\n\tif (debug) {\r\n\t\tconsole.table(store.getSpaces());\r\n\t}\r\n\r\n\tconst parsedProps = {\r\n\t\t...props,\r\n\t\t...{\r\n\t\t\tid: spaceId,\r\n\t\t\tzIndex: coalesce(props.zIndex, layer),\r\n\t\t},\r\n\t};\r\n\r\n\tif (!space) {\r\n\t\tspace = store.createSpace(parent, parsedProps, update);\r\n\t\tstore.addSpace(space);\r\n\t} else {\r\n\t\tstore.updateSpace(space, parsedProps);\r\n\t}\r\n\r\n\tconst resizeHandles = useSpaceResizeHandles(store, space, props.position);\r\n\r\n\tReact.useEffect(() => {\r\n\t\tconst rect = elementRef.current!.getBoundingClientRect() as DOMRect;\r\n\t\tspace!.dimension = {\r\n\t\t\t...rect,\r\n\t\t\t...{\r\n\t\t\t\tleft: Math.floor(rect.left),\r\n\t\t\t\ttop: Math.floor(rect.top),\r\n\t\t\t\tright: Math.floor(rect.right),\r\n\t\t\t\tbottom: Math.floor(rect.bottom),\r\n\t\t\t\twidth: Math.floor(rect.width),\r\n\t\t\t\theight: Math.floor(rect.height),\r\n\t\t\t\tx: Math.floor(rect.x),\r\n\t\t\t\ty: Math.floor(rect.y),\r\n\t\t\t},\r\n\t\t};\r\n\t\tsetDomRect(space!.dimension);\r\n\r\n\t\tif (props.trackSize) {\r\n\t\t\tresizeSensor.current = new ResizeSensor(elementRef.current!, (size) => {\r\n\t\t\t\tspace!.dimension = {\r\n\t\t\t\t\t...rect,\r\n\t\t\t\t\t...{\r\n\t\t\t\t\t\twidth: Math.floor(size.width),\r\n\t\t\t\t\t\theight: Math.floor(size.height),\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\tsetDomRect(space!.dimension);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tresizeSensor.current && resizeSensor.current.detach();\r\n\t\t\tstore.removeSpace(space!);\r\n\t\t};\r\n\t}, []);\r\n\r\n\treturn { space: space, resizeHandles: resizeHandles, domRect: domRect, elementRef: elementRef };\r\n}\r\n\r\ninterface IResizeHandleProps {\r\n\tid?: string;\r\n\tkey: string | number;\r\n\tclassName?: string;\r\n\tonMouseDown: (e: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonTouchStart: (e: React.TouchEvent<HTMLElement>) => void;\r\n}\r\n\r\nexport function useSpaceResizeHandles(store: ISpaceStore, space: ISpaceDefinition, position: IPositionalProps | undefined) {\r\n\tconst mouseHandles: IResizeHandleProps[] = [];\r\n\r\n\tif (position && position.rightResizable) {\r\n\t\tmouseHandles.push({\r\n\t\t\tid: `${space.id}-m`,\r\n\t\t\tkey: \"right\",\r\n\t\t\tclassName: `spaces-resize-handle resize-right`,\r\n\t\t\tonMouseDown: (event) => store.startMouseResize(ResizeType.Right, space, space.width, event),\r\n\t\t\tonTouchStart: (event) => store.startTouchResize(ResizeType.Right, space, space.width, event),\r\n\t\t});\r\n\t}\r\n\r\n\tif (position && position.leftResizable) {\r\n\t\tmouseHandles.push({\r\n\t\t\tid: `${space.id}-m`,\r\n\t\t\tkey: \"left\",\r\n\t\t\tclassName: `spaces-resize-handle resize-left`,\r\n\t\t\tonMouseDown: (event) => store.startMouseResize(ResizeType.Left, space, space.width, event),\r\n\t\t\tonTouchStart: (event) => store.startTouchResize(ResizeType.Left, space, space.width, event),\r\n\t\t});\r\n\t}\r\n\r\n\tif (position && position.topResizable) {\r\n\t\tmouseHandles.push({\r\n\t\t\tid: `${space.id}-m`,\r\n\t\t\tkey: \"top\",\r\n\t\t\tclassName: `spaces-resize-handle resize-top`,\r\n\t\t\tonMouseDown: (event) => store.startMouseResize(ResizeType.Top, space, space.height, event),\r\n\t\t\tonTouchStart: (event) => store.startTouchResize(ResizeType.Top, space, space.height, event),\r\n\t\t});\r\n\t}\r\n\r\n\tif (position && position.bottomResizable) {\r\n\t\tmouseHandles.push({\r\n\t\t\tid: `${space.id}-m`,\r\n\t\t\tkey: \"bottom\",\r\n\t\t\tclassName: `spaces-resize-handle resize-bottom`,\r\n\t\t\tonMouseDown: (event) => store.startMouseResize(ResizeType.Bottom, space, space.height, event),\r\n\t\t\tonTouchStart: (event) => store.startTouchResize(ResizeType.Bottom, space, space.height, event),\r\n\t\t});\r\n\t}\r\n\r\n\treturn {\r\n\t\tmouseHandles\r\n\t};\r\n}\r\n","import * as React from \"react\";\r\n\r\nexport const Centered: React.FC = (props) => <div className={`spaces-centered`}>{props.children}</div>;\r\n","import * as React from \"react\";\r\n\r\nexport const CenteredVertically: React.FC = (props) => <div className={`spaces-centered-vertically`}>{props.children}</div>;\r\n","import { ISpaceProps, CenterType, ResizeHandlePlacement, AnchorType } from \"../core-types\";\r\nimport { useSpace, ParentContext, LayerContext, DOMRectContext } from \"../core-react\";\r\nimport * as React from \"react\";\r\nimport { Centered } from \"./Centered\";\r\nimport { CenteredVertically } from \"./CenteredVertically\";\r\nimport { shortuuid } from \"../core-utils\";\r\n\r\nfunction applyCentering(children: React.ReactNode, centerType: CenterType | undefined) {\r\n\tswitch (centerType) {\r\n\t\tcase CenterType.Vertical:\r\n\t\t\treturn <CenteredVertically>{children}</CenteredVertically>;\r\n\t\tcase CenterType.HorizontalVertical:\r\n\t\t\treturn <Centered>{children}</Centered>;\r\n\t}\r\n\treturn children;\r\n}\r\n\r\nexport class Space extends React.Component<ISpaceProps> {\r\n\tpublic render() {\r\n\t\treturn <SpaceInner {...this.props} wrapperInstance={this} />;\r\n\t}\r\n}\r\n\r\nconst SpaceInner: React.FC<ISpaceProps & { wrapperInstance: Space }> = (props) => {\r\n\tif (!props.id && !props.wrapperInstance[\"_react_spaces_uniqueid\"]) {\r\n\t\tprops.wrapperInstance[\"_react_spaces_uniqueid\"] = `s${shortuuid()}`;\r\n\t}\r\n\r\n\tconst {\r\n\t\tstyle,\r\n\t\tclassName,\r\n\t\tonClick,\r\n\t\tonDoubleClick,\r\n\t\tonMouseDown,\r\n\t\tonMouseEnter,\r\n\t\tonMouseLeave,\r\n\t\tonMouseMove,\r\n\t\tonTouchStart,\r\n\t\tonTouchMove,\r\n\t\tonTouchEnd,\r\n\t\tchildren,\r\n\t} = props;\r\n\r\n\tconst events = {\r\n\t\tonClick: onClick,\r\n\t\tonDoubleClick: onDoubleClick,\r\n\t\tonMouseDown: onMouseDown,\r\n\t\tonMouseEnter: onMouseEnter,\r\n\t\tonMouseLeave: onMouseLeave,\r\n\t\tonMouseMove: onMouseMove,\r\n\t\tonTouchStart: onTouchStart,\r\n\t\tonTouchMove: onTouchMove,\r\n\t\tonTouchEnd: onTouchEnd,\r\n\t};\r\n\r\n\tconst { space, domRect, elementRef, resizeHandles } = useSpace({\r\n\t\t...props,\r\n\t\t...{ id: props.id || props.wrapperInstance[\"_react_spaces_uniqueid\"] },\r\n\t});\r\n\r\n\tReact.useEffect(() => {\r\n\t\tspace.element = elementRef.current!;\r\n\t}, []);\r\n\r\n\tconst userClasses = className ? className.split(\" \").map((c) => c.trim()) : [];\r\n\r\n\tconst outerClasses = [\r\n\t\t...[\"spaces-space\", space.children.find((s) => s.resizing) ? \"spaces-resizing\" : undefined],\r\n\t\t...userClasses.map((c) => `${c}-container`),\r\n\t].filter((c) => c);\r\n\r\n\tconst innerClasses = [...[\"spaces-space-inner\"], ...userClasses];\r\n\r\n\tlet innerStyle = style;\r\n\tif (space.handlePlacement === ResizeHandlePlacement.Inside) {\r\n\t\tinnerStyle = {\r\n\t\t\t...style,\r\n\t\t\t...{\r\n\t\t\t\tleft: space.anchor === AnchorType.Right ? space.handleSize : undefined,\r\n\t\t\t\tright: space.anchor === AnchorType.Left ? space.handleSize : undefined,\r\n\t\t\t\ttop: space.anchor === AnchorType.Bottom ? space.handleSize : undefined,\r\n\t\t\t\tbottom: space.anchor === AnchorType.Top ? space.handleSize : undefined,\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tconst centeredContent = applyCentering(children, props.centerContent);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{resizeHandles.mouseHandles.map((r) => (\r\n\t\t\t\t<div {...r} />\r\n\t\t\t))}\r\n\t\t\t{React.createElement(\r\n\t\t\t\tprops.as || \"div\",\r\n\t\t\t\t{\r\n\t\t\t\t\t...{\r\n\t\t\t\t\t\tid: space.id,\r\n\t\t\t\t\t\tref: elementRef,\r\n\t\t\t\t\t\tclassName: outerClasses.join(\" \"),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t...events,\r\n\t\t\t\t},\r\n\t\t\t\t<div className={innerClasses.join(\" \")} style={innerStyle}>\r\n\t\t\t\t\t<ParentContext.Provider value={space.id}>\r\n\t\t\t\t\t\t<LayerContext.Provider value={undefined}>\r\n\t\t\t\t\t\t\t<DOMRectContext.Provider value={domRect}>{centeredContent}</DOMRectContext.Provider>\r\n\t\t\t\t\t\t</LayerContext.Provider>\r\n\t\t\t\t\t</ParentContext.Provider>\r\n\t\t\t\t</div>,\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n};\r\n","import { ICommonProps, SizeUnit, Type, AnchorType, ResizeHandlePlacement } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps } from \"../core-react\";\r\n\r\ninterface IAnchorProps extends ICommonProps {\r\n\tsize: SizeUnit;\r\n\torder?: number;\r\n\tresizable?: boolean;\r\n\thandleSize?: number;\r\n\thandlePlacement?: ResizeHandlePlacement;\r\n\tminimumSize?: number;\r\n\tmaximumSize?: number;\r\n\tonResizeStart?: () => void | boolean;\r\n\tonResizeEnd?: (newSize: SizeUnit) => void;\r\n}\r\n\r\nexport const anchoredProps = {\r\n\t...commonProps,\r\n\t...{\r\n\t\tsize: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\r\n\t\torder: PropTypes.number,\r\n\t\tresizable: PropTypes.bool,\r\n\t\thandleSize: PropTypes.number,\r\n\t\thandlePlacement: PropTypes.oneOf([ResizeHandlePlacement.Inside, ResizeHandlePlacement.OverlayBoundary, ResizeHandlePlacement.OverlayInside]),\r\n\t\tminimumSize: PropTypes.number,\r\n\t\tmaximumSize: PropTypes.number,\r\n\t\tonResizeStart: PropTypes.func,\r\n\t\tonResizeEnd: PropTypes.func,\r\n\t},\r\n};\r\n\r\nexport const resizableProps = {\r\n\t...commonProps,\r\n\t...{\r\n\t\tsize: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\r\n\t\torder: PropTypes.number,\r\n\t\thandleSize: PropTypes.number,\r\n\t\thandlePlacement: PropTypes.oneOf([ResizeHandlePlacement.Inside, ResizeHandlePlacement.OverlayBoundary, ResizeHandlePlacement.OverlayInside]),\r\n\t\tminimumSize: PropTypes.number,\r\n\t\tmaximumSize: PropTypes.number,\r\n\t\tonResizeStart: PropTypes.func,\r\n\t\tonResizeEnd: PropTypes.func,\r\n\t},\r\n};\r\n\r\nexport const LeftResizable: React.FC<Omit<IAnchorProps, \"resizable\">> = ({ children, size, ...props }) => (\r\n\t<Space {...props} type={Type.Anchored} anchor={AnchorType.Left} position={{ left: 0, top: 0, bottom: 0, rightResizable: true, width: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nLeftResizable.propTypes = resizableProps;\r\n\r\nexport const Left: React.FC<IAnchorProps> = ({ size, children, resizable, ...commonProps }) => (\r\n\t<Space\r\n\t\t{...commonProps}\r\n\t\ttype={Type.Anchored}\r\n\t\tanchor={AnchorType.Left}\r\n\t\tposition={{ left: 0, top: 0, bottom: 0, rightResizable: resizable, width: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nLeft.propTypes = anchoredProps;\r\n\r\nexport const TopResizable: React.FC<Omit<IAnchorProps, \"resizable\">> = ({ children, size, ...props }) => (\r\n\t<Space {...props} type={Type.Anchored} anchor={AnchorType.Top} position={{ left: 0, top: 0, right: 0, bottomResizable: true, height: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nTopResizable.propTypes = resizableProps;\r\n\r\nexport const Top: React.FC<IAnchorProps> = ({ size, children, resizable, ...commonProps }) => (\r\n\t<Space\r\n\t\t{...commonProps}\r\n\t\ttype={Type.Anchored}\r\n\t\tanchor={AnchorType.Top}\r\n\t\tposition={{ left: 0, top: 0, right: 0, bottomResizable: resizable, height: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nTop.propTypes = anchoredProps;\r\n\r\nexport const RightResizable: React.FC<Omit<IAnchorProps, \"resizable\">> = ({ children, size, ...props }) => (\r\n\t<Space {...props} type={Type.Anchored} anchor={AnchorType.Right} position={{ bottom: 0, top: 0, right: 0, leftResizable: true, width: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nRightResizable.propTypes = resizableProps;\r\n\r\nexport const Right: React.FC<IAnchorProps> = ({ size, children, resizable, ...commonProps }) => (\r\n\t<Space\r\n\t\t{...commonProps}\r\n\t\ttype={Type.Anchored}\r\n\t\tanchor={AnchorType.Right}\r\n\t\tposition={{ bottom: 0, top: 0, right: 0, leftResizable: resizable, width: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nRight.propTypes = anchoredProps;\r\n\r\nexport const BottomResizable: React.FC<Omit<IAnchorProps, \"resizable\">> = ({ children, size, ...props }) => (\r\n\t<Space {...props} type={Type.Anchored} anchor={AnchorType.Bottom} position={{ bottom: 0, left: 0, right: 0, topResizable: true, height: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nBottomResizable.propTypes = resizableProps;\r\n\r\nexport const Bottom: React.FC<IAnchorProps> = ({ size, children, resizable, ...commonProps }) => (\r\n\t<Space\r\n\t\t{...commonProps}\r\n\t\ttype={Type.Anchored}\r\n\t\tanchor={AnchorType.Bottom}\r\n\t\tposition={{ bottom: 0, left: 0, right: 0, topResizable: resizable, height: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nBottom.propTypes = anchoredProps;\r\n","import { ICommonProps, Type, SizeUnit, IPositionalProps, AnchorType } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps } from \"../core-react\";\r\n\r\ninterface ICustomProps extends ICommonProps {\r\n\tleft?: SizeUnit | undefined;\r\n\ttop?: SizeUnit | undefined;\r\n\tright?: SizeUnit | undefined;\r\n\tbottom?: SizeUnit | undefined;\r\n\twidth?: SizeUnit | undefined;\r\n\theight?: SizeUnit | undefined;\r\n\tisPositioned?: boolean;\r\n\tanchor?: AnchorType;\r\n\tanchorSize?: SizeUnit;\r\n\tresizable?: boolean;\r\n\thandleSize?: number;\r\n\toverlayHandle?: boolean;\r\n\tminimumSize?: number;\r\n\tmaximumSize?: number;\r\n\tonResizeStart?: () => void | boolean;\r\n\tonResizeEnd?: (newSize: SizeUnit) => void;\r\n}\r\n\r\nexport const Custom: React.FC<ICustomProps> = ({\r\n\tchildren,\r\n\tleft,\r\n\ttop,\r\n\tright,\r\n\tbottom,\r\n\twidth,\r\n\theight,\r\n\tanchorSize,\r\n\tanchor,\r\n\tisPositioned,\r\n\tresizable,\r\n\t...props\r\n}) => {\r\n\tlet position: IPositionalProps;\r\n\tlet type = Type.Positioned;\r\n\r\n\tif (!isPositioned) {\r\n\t\tif (anchor === AnchorType.Left) {\r\n\t\t\tposition = { left: 0, top: 0, bottom: 0, width: anchorSize, right: undefined, rightResizable: resizable };\r\n\t\t\ttype = Type.Anchored;\r\n\t\t} else if (anchor === AnchorType.Right) {\r\n\t\t\tposition = { right: 0, top: 0, bottom: 0, width: anchorSize, left: undefined, leftResizable: resizable };\r\n\t\t\ttype = Type.Anchored;\r\n\t\t} else if (anchor === AnchorType.Top) {\r\n\t\t\tposition = { left: 0, top: 0, right: 0, height: anchorSize, bottom: undefined, bottomResizable: resizable };\r\n\t\t\ttype = Type.Anchored;\r\n\t\t} else if (anchor === AnchorType.Bottom) {\r\n\t\t\tposition = { left: 0, bottom: 0, right: 0, height: anchorSize, top: undefined, topResizable: resizable };\r\n\t\t\ttype = Type.Anchored;\r\n\t\t} else {\r\n\t\t\tposition = { left: 0, top: 0, bottom: 0, right: 0, width: undefined, height: undefined };\r\n\t\t\ttype = Type.Fill;\r\n\t\t}\r\n\t} else {\r\n\t\tposition = { left: left, top: top, right: right, bottom: bottom, width: width, height: height };\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Space {...props} type={type} anchor={anchor} position={position}>\r\n\t\t\t{children}\r\n\t\t</Space>\r\n\t);\r\n};\r\n\r\nCustom.propTypes = {\r\n\t...commonProps,\r\n\t...{\r\n\t\tleft: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\ttop: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tright: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tbottom: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\twidth: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\theight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tisPositioned: PropTypes.bool,\r\n\t\tanchor: PropTypes.oneOf([AnchorType.Left, AnchorType.Top, AnchorType.Right, AnchorType.Bottom]),\r\n\t\tanchorSize: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tresizable: PropTypes.bool,\r\n\t\thandleSize: PropTypes.number,\r\n\t\tminimumSize: PropTypes.number,\r\n\t\tmaximumSize: PropTypes.number,\r\n\t\tonResizeStart: PropTypes.func,\r\n\t\tonResizeEnd: PropTypes.func,\r\n\t},\r\n};\r\n","import { ICommonProps, Type } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport { commonProps } from \"../core-react\";\r\n\r\nexport const Fill: React.FC<ICommonProps> = (props) => (\r\n\t<Space {...props} type={Type.Fill} position={{ left: 0, top: 0, right: 0, bottom: 0 }}>\r\n\t\t{props.children}\r\n\t</Space>\r\n);\r\n\r\nFill.propTypes = commonProps;\r\n","import { ICommonProps, SizeUnit, Type } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps } from \"../core-react\";\r\n\r\ninterface IFixedProps extends ICommonProps {\r\n\twidth?: SizeUnit;\r\n\theight: SizeUnit;\r\n}\r\n\r\nexport const Fixed: React.FC<IFixedProps> = ({ width, height, children, ...commonProps }) => (\r\n\t<Space {...commonProps} type={Type.Fixed} position={{ width: width, height: height }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nFixed.propTypes = {\r\n\t...commonProps,\r\n\t...{\r\n\t\twidth: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\theight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\r\n\t},\r\n};\r\n","import * as React from \"react\";\r\nimport { LayerContext } from \"../core-react\";\r\nimport * as PropTypes from \"prop-types\";\r\n\r\nexport const Layer: React.FC<{ zIndex: number }> = (props) => <LayerContext.Provider value={props.zIndex}>{props.children}</LayerContext.Provider>;\r\n\r\nLayer.propTypes = {\r\n\tzIndex: PropTypes.number.isRequired,\r\n};\r\n","import { ICommonProps, Type, SizeUnit } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps } from \"../core-react\";\r\n\r\ninterface IPositionedProps extends ICommonProps {\r\n\tleft?: SizeUnit;\r\n\ttop?: SizeUnit;\r\n\tright?: SizeUnit;\r\n\tbottom?: SizeUnit;\r\n\twidth?: SizeUnit;\r\n\theight?: SizeUnit;\r\n\tresizable?: boolean;\r\n}\r\n\r\nexport const Positioned: React.FC<IPositionedProps> = ({ left, top, right, bottom, width, height, resizable, ...props }) => (\r\n\t<Space {...props} type={Type.Positioned} position={{ left: left, top: top, right: right, bottom: bottom, width: width, height: height }}>\r\n\t\t{props.children}\r\n\t</Space>\r\n);\r\n\r\nPositioned.propTypes = {\r\n\t...commonProps,\r\n\t...{\r\n\t\tleft: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\ttop: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tright: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tbottom: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\twidth: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\theight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tresizable: PropTypes.bool,\r\n\t},\r\n};\r\n","import * as React from \"react\";\r\nimport { DOMRectContext } from \"../core-react\";\r\n\r\ninterface ISpaceInfoProps {\r\n\tchildren: (info: DOMRect) => JSX.Element;\r\n}\r\n\r\nexport const Info: React.FC<ISpaceInfoProps> = (props) => {\r\n\tconst domRect = React.useContext(DOMRectContext);\r\n\r\n\tif (domRect) {\r\n\t\treturn props.children(domRect);\r\n\t}\r\n\r\n\treturn props.children({ left: 0, top: 0, right: 0, bottom: 0, width: 0, height: 0, x: 0, y: 0, toJSON: () => \"\" });\r\n};\r\n","import { ICommonProps, Type, SizeUnit } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps } from \"../core-react\";\r\n\r\ninterface IViewPortProps extends ICommonProps {\r\n\tleft?: SizeUnit;\r\n\tright?: SizeUnit;\r\n\ttop?: SizeUnit;\r\n\tbottom?: SizeUnit;\r\n}\r\n\r\nexport const ViewPort: React.FC<IViewPortProps> = ({ left, top, right, bottom, children, ...commonProps }) => (\r\n\t<Space {...commonProps} type={Type.ViewPort} position={{ left: left || 0, top: top || 0, right: right || 0, bottom: bottom || 0 }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nViewPort.propTypes = {\r\n\t...commonProps,\r\n\t...{\r\n\t\tleft: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\ttop: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tright: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tbottom: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t},\r\n};\r\n","import * as React from \"react\";\r\nimport { IReactSpacesOptions, OptionsContext } from \"../core-react\";\r\n\r\nexport const Options: React.FC<IReactSpacesOptions> = ({ children, ...opts }) => {\r\n\treturn <OptionsContext.Provider value={opts}>{children}</OptionsContext.Provider>;\r\n};\r\n"],"names":["Type","Orientation","ResizeType","shortuuid","firstPart","Math","random","secondPart","toString","slice","getSizeString","size","css","dontAddCalc","adjusted","length","resized","parts","undefined","push","forEach","l","join","coalesce","_i","args","find","x","adjustmentsEqual","item1","item2","i","len","throttle","callback","limit","wait","setTimeout","styleDefinition","space","cssElements","style","position","left","top","right","bottom","width","height","zIndex","cssString","id","scrollable","handleOffset","touchHandleSize","handleSize","handlePlacement","ResizeHandlePlacement","Inside","OverlayInside","OverlayBoundary","canResizeLeft","canResizeTop","canResizeRight","canResizeBottom","updateStyleDefinition","definition","existing","document","getElementById","innerHTML","newStyle","createElement","head","appendChild","removeStyleDefinition","removeChild","AnchorType","CenterType","MoveEvent","EndEvent","RESIZE_THROTTLE","createResize","store","startResize","resizeType","e","targetSize","endEvent","moveEvent","getCoords","onResizeStart","result","originalCoords","resizing","updateParent","resize","y","startSize","originalX","originalY","minimumAdjust","maximumAdjust","adjustment","orientation","Horizontal","Left","Top","updateStyles","withPreventDefault","moved","newCoords","lastX","lastY","preventDefault","window","requestAnimationFrame","rect","element","getBoundingClientRect","minimumSize","maximumSize","removeListener","removeEventListener","onResizeEnd","currentRect","floor","Right","addEventListener","spaceDefaults","centerContent","dimension","toJSON","adjustLeft","adjustRight","adjustTop","adjustBottom","adjustEdge","anchoredChildren","anchorTypes","Bottom","getPosition","type","ViewPort","Fixed","getOrientation","anchor","Vertical","anchorUpdates","update","sizeInfoDefault","createStore","getSpace","getSpaces","s","recalcSpaces","parent","spaces","onlyUnique","value","index","self","indexOf","orderedSpaces","children","t","anchoredSpaces","filter","map","anchoredSpacesInLayer","c","order","unorderedSpaces","maxOrder","a","reduce","b","max","idx","changed","Fill","info","as","Anchored","adjusted_1","addSpace","parentId","parentSpace","removeSpace","newSpaces","parent_1","updateSpace","props","rightResizable","leftResizable","bottomResizable","topResizable","None","createSpace","startMouseResize","startTouchResize","commonProps","newSpace","__assign","event","Mouse","clientX","clientY","Touch","touches","ParentContext","React.createContext","DOMRectContext","LayerContext","OptionsContext","currentStore","PropTypes.string","className","PropTypes.oneOfType","PropTypes.object","PropTypes.array","PropTypes.oneOf","HorizontalVertical","PropTypes.number","PropTypes.bool","trackSize","onClick","PropTypes.func","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onTouchStart","onTouchMove","onTouchEnd","useForceUpdate","setTick","React.useState","React.useCallback","tick","useSpace","React.useContext","layer","debug","spaceId","elementRef","React.useRef","resizeSensor","_a","domRect","setDomRect","console","table","parsedProps","resizeHandles","useSpaceResizeHandles","React.useEffect","current","ResizeSensor","detach","mouseHandles","key","Centered","React.createElement","CenteredVertically","applyCentering","centerType","__extends","Space","SpaceInner","this","wrapperInstance","React.Component","onDoubleClick","events","userClasses","split","trim","outerClasses","__spreadArrays","innerClasses","innerStyle","centeredContent","r","ref","Provider","anchoredProps","isRequired","resizable","resizableProps","LeftResizable","propTypes","TopResizable","RightResizable","BottomResizable","Custom","anchorSize","isPositioned","Positioned","Layer","Info","Options","opts"],"mappings":"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"}