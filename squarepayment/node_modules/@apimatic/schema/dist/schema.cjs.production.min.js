"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=(e=require("lodash.flatten"))&&"object"==typeof e&&"default"in e?e.default:e;function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(a[n]=e[n]);return a}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e){for(var t=[],n=0;n<e.length;n++)t.push([n,e[n]]);return t}function u(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}function i(e){return"string"==typeof e?'"'+e.replace(/"/g,'"')+'"':""+e}function l(e){return e}function p(e){return function(t,n){return e(t)?[]:n.fail()}}function f(e){return n({},t={type:function(){return e.type},validateBeforeMap:e.validate,validateBeforeUnmap:e.validate,map:e.map,unmap:e.map},{validateBeforeMapXml:t.validateBeforeUnmap,mapXml:t.map,unmapXml:t.unmap});var t}function m(e){return"number"==typeof e||"string"==typeof e&&!isNaN(e)}function c(e){return"number"==typeof e?e:+e}function v(e,t){var n=new Set(t),r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&!n.has(a)&&(r[a]=e[a]);return r}function d(e){return-1!==e.indexOf(" ")?i(e):e}function y(e,t){return{value:e,type:t,branch:[e],path:[]}}function s(e){var r=function(t,n,r){return s({value:n,type:r.type(),branch:[].concat(e.branch,[n]),path:[].concat(e.path,[t])})},a=function(e,t,n){return e.map((function(e){return n(e,r(e[0],e[1],t))}))};return n({},e,{createChild:r,flatmapChildren:function(){return t(a.apply(void 0,arguments))},mapChildren:a,fail:function(t){return[n({},e,{message:h(e,t)})]}})}function h(e,t){var n;return t=(null!=(n=t)?n:"Expected value to be of type '"+e.type+"' but found '"+typeof e.value+"'.")+"\n\nGiven value: "+JSON.stringify(e.value)+"\nType: '"+typeof e.value+"'\nExpected type: '"+e.type+"'",e.path.length>0&&(t+="\nPath: "+e.path.map((function(e){return d(e.toString())})).join(" â€º ")),t}function b(e){return"string"==typeof e}function j(e){return"boolean"==typeof e||"string"==typeof e&&("true"===e||"false"===e)}function X(e,t){return null==e||e===t}function x(e){var t=function(t,n,r){return"object"!=typeof n||null===n?r.fail():r.flatmapChildren(u(n),e,(function(n,r){return e[t](n[1],r)}))};return{type:function(){return"Record<string,"+e.type()+">"},validateBeforeMap:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(void 0,["validateBeforeMap"].concat(n))},validateBeforeUnmap:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(void 0,["validateBeforeUnmap"].concat(n))},map:function(t,n){var r={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var o=t[a];r[a]=e.map(o,n.createChild(a,o,e))}return r},unmap:function(t,n){var r={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var o=t[a];r[a]=e.unmap(o,n.createChild(a,o,e))}return r},validateBeforeMapXml:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(void 0,["validateBeforeMapXml"].concat(n))},mapXml:function(t,n){var r={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var o=t[a];r[a]=e.mapXml(o,n.createChild(a,o,e))}return r},unmapXml:function(t,n){var r={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var o=t[a];r[a]=e.unmapXml(o,n.createChild(a,o,e))}return r}}}function B(e){var t=g(e,!1,!1);return t.type=function(){return"StrictObject<{"+Object.keys(e).map(d).join(",")+"}>"},t}function O(e){return g(e,!0,!0)}function M(e){var t=g(e,!0,!1);return t.type=function(){return"Object<{"+Object.keys(e).map(d).join(",")+"}>"},t}function g(e,t,n){var r=Object.keys(e),a=C(e),o=function(e){var t={},n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a,o,u=e[r],i=u[0],l=u[2];!0===(null==l?void 0:l.isAttr)?n[null!=(a=l.xmlName)?a:i]=r:t[null!=(o=null==l?void 0:l.xmlName)?o:i]=r}return{elementsToProps:t,attributesToProps:n}}(e),u=function(e){var t={},n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a,o=e[r],u=o[2];((null==u?void 0:u.isAttr)?n:t)[r]=[null!=(a=null==u?void 0:u.xmlName)?a:o[0],o[1],u]}return{elementsSchema:t,attributesSchema:n}}(e),i=function(e){return{attributesSchema:C(e.attributesSchema),elementsSchema:C(e.elementsSchema)}}(u);return{type:function(){return"Object<{"+r.map(d).join(",")+",...}>"},validateBeforeMap:P(e,"validateBeforeMap",t),validateBeforeUnmap:P(a,"validateBeforeUnmap",t),map:U(e,"map",n),unmap:U(a,"unmap",n),validateBeforeMapXml:A(e,o,t),mapXml:S(u,n),unmapXml:w(i,n),objectSchema:e}}function A(e,t,n){var a=t.elementsToProps,o=t.attributesToProps;return function(t,u){var i;if("object"!=typeof t||null===t)return u.fail();var l=t.$,p=r(t,["$"]);return l=null!=(i=l)?i:{},[].concat(N({validationMethod:"validateBeforeMapXml",propTypeName:"child elements",propTypePrefix:"element",valueTypeName:"element",propMapping:a,objectSchema:e,valueObject:p,ctxt:u,allowAdditionalProperties:n}),N({validationMethod:"validateBeforeMapXml",propTypeName:"attributes",propTypePrefix:"@",valueTypeName:"element",propMapping:o,objectSchema:e,valueObject:l,ctxt:u,allowAdditionalProperties:n}))}}function S(e,t){var a=e.attributesSchema,o=U(e.elementsSchema,"mapXml",t),i=U(a,"mapXml",!1),l=u(a).map((function(e){return e[1][0]}));return function(e,a){var u,p=e.$,f=r(e,["$"]);p=null!=(u=p)?u:{};var m=n({},i(p,a),o(f,a));if(t){var c=v(p,l);Object.keys(c).length>0&&(m.$=c)}return m}}function w(e,t){var a=e.attributesSchema,o=U(e.elementsSchema,"unmapXml",t),i=U(a,"unmapXml",!1),l=u(a).map((function(e){return e[1][0]}));return function(e,a){var u=e.$,p=r(e,["$"]),f="object"==typeof u&&null!==u&&t?u:{};return n({},o(v(p,l),a),{$:n({},f,i(e,a))})}}function N(e){var t=e.validationMethod,n=e.propTypeName,r=e.propTypePrefix,a=e.valueTypeName,o=e.propMapping,u=e.objectSchema,l=e.valueObject,p=e.ctxt,f=e.allowAdditionalProperties,m=[],c=new Set,v=new Set(Object.keys(l));for(var d in o){var y=u[o[d]][1];v.delete(d),d in l?m.push.apply(m,y[t](l[d],p.createChild(r+d,l[d],y))):0!==y.type().indexOf("Optional<")&&c.add(d)}var s=Array.from(v);s.length>0&&!f&&m.push.apply(m,p.fail("Some unknown "+n+" were found in the "+a+": "+s.map(i).join(", ")+"."));var h=Array.from(c);return h.length>0&&m.push.apply(m,p.fail("Some "+n+" are missing in the "+a+": "+h.map(i).join(", ")+".")),m}function P(e,t,n){var r=function(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[e[n][0]]=n);return t}(e);return function(a,o){return"object"!=typeof a||null===a?o.fail():N({validationMethod:t,propTypeName:"properties",propTypePrefix:"",valueTypeName:"object",propMapping:r,objectSchema:e,valueObject:a,ctxt:o,allowAdditionalProperties:n})}}function U(e,t,n){return function(r,a){var o={},u=r,i=new Set(Object.keys(u));for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var p=e[l],f=p[0],m=u[f];i.delete(f),0===p[1].type().indexOf("Optional<")&&void 0===m||(o[l]=p[1][t](m,a.createChild(f,m,p[1])))}return n&&i.forEach((function(e){o[e]=u[e]})),o}}function C(e){var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];t[r[0]]=[n,r[1],r[2]]}return t}exports.array=function(e,t){return{type:function(){return"Array<"+e.type()+">"},validateBeforeMap:function(t,n){return Array.isArray(t)?n.flatmapChildren(o(t),e,(function(t,n){return e.validateBeforeMap(t[1],n)})):n.fail()},validateBeforeUnmap:function(t,n){return Array.isArray(t)?n.flatmapChildren(o(t),e,(function(t,n){return e.validateBeforeUnmap(t[1],n)})):n.fail()},map:function(t,n){return n.mapChildren(o(t),e,(function(t,n){return e.map(t[1],n)}))},unmap:function(t,n){return n.mapChildren(o(t),e,(function(t,n){return e.unmap(t[1],n)}))},mapXml:function(n,r){var a=n;return(null==t?void 0:t.xmlItemName)&&(r=r.createChild(t.xmlItemName,a=n[t.xmlItemName],e)),r.mapChildren(o(a),e,(function(t,n){return e.mapXml(t[1],n)}))},unmapXml:function(n,r){var a,u=r.mapChildren(o(n),e,(function(t,n){return e.unmapXml(t[1],n)}));return(null==t?void 0:t.xmlItemName)?((a={})[t.xmlItemName]=u,a):u},validateBeforeMapXml:function(n,r){var a=n;if(null==t?void 0:t.xmlItemName){if("object"!=typeof n||null===n||!(t.xmlItemName in n))return r.fail("Expected array to be wrapped with XML element "+t.xmlItemName+".");r=r.createChild(t.xmlItemName,a=n[t.xmlItemName],e)}return Array.isArray(a)?r.flatmapChildren(o(a),e,(function(t,n){return e.validateBeforeMapXml(t[1],n)})):r.fail()}}},exports.boolean=function(){return f({type:"boolean",validate:p(j),map:function(e){return"boolean"==typeof e?e:"true"===e}})},exports.defaults=function(e,t){return{type:function(){return"Defaults<"+e.type()+","+i(t)+">"},validateBeforeMap:function(n,r){return X(n,t)?[]:e.validateBeforeMap(n,r)},validateBeforeUnmap:function(n,r){return X(n,t)?[]:e.validateBeforeUnmap(n,r)},map:function(n,r){return X(n,t)?t:e.map(n,r)},unmap:function(n,r){return X(n,t)?t:e.unmap(n,r)},validateBeforeMapXml:function(n,r){return X(n,t)?[]:e.validateBeforeMapXml(n,r)},mapXml:function(n,r){return X(n,t)?t:e.mapXml(n,r)},unmapXml:function(n,r){return X(n,t)?t:e.unmapXml(n,r)}}},exports.dict=x,exports.dictWithXmlEntries=function(e){var t=x(e),r=n({},t);return r.unmapXml=function(e,n){return{entry:u(t.unmapXml(e,n)).map((function(e){return{$:{key:e[0]},_:e[1]}}))}},r.mapXml=function(e,n){if(!("entry"in e))return{};var r=e.entry;Array.isArray(r)||(r=[r]);for(var o,u={},i=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}(r);!(o=i()).done;){var l=o.value;u[l.$.key]=l._}return t.mapXml(u,n)},r.validateBeforeMapXml=function(e,n){if("object"!=typeof e||null===e)return n.fail();if(!("entry"in e))return[];var r=e.entry;Array.isArray(r)||(r=[r]);for(var a={},o=0;o<r.length;o++){var u=r[o];if("object"!=typeof u||null===u)return n.fail('Expected "entry" to be an XML element.');if(!("$"in u)||!("key"in u.$))return n.fail('Expected "entry" element to have an attribute named "key".');a[u.$.key]=u._}return t.validateBeforeMapXml(a,n)},r},exports.discriminatedObject=function(e,t,n,r,a){var o=function(e,t,a){if(void 0===a&&(a=!1),"object"==typeof e&&null!==e&&(a&&function(e,t){return"$"in e&&"object"==typeof e.$&&t in e.$}(e,t)||!a&&t in e)){var o=a?e.$[t]:e[t];if("string"==typeof o&&o in n)return n[o]}return n[r]};return{type:function(){return"DiscriminatedUnion<"+t+",["+u(n).map((function(e){return e[1].type})).join(",")+"]>"},map:function(e,n){return o(e,t).map(e,n)},unmap:function(t,n){return o(t,e).unmap(t,n)},validateBeforeMap:function(e,n){return o(e,t).validateBeforeMap(e,n)},validateBeforeUnmap:function(t,n){return o(t,e).validateBeforeUnmap(t,n)},mapXml:function(e,n){var r;return o(e,null!=(r=null==a?void 0:a.xmlName)?r:t,null==a?void 0:a.isAttr).mapXml(e,n)},unmapXml:function(t,n){return o(t,e).unmapXml(t,n)},validateBeforeMapXml:function(e,n){var r;return o(e,null!=(r=null==a?void 0:a.xmlName)?r:t,null==a?void 0:a.isAttr).validateBeforeMapXml(e,n)}}},exports.expandoObject=O,exports.extendExpandoObject=function(e,t){return O(n({},e.objectSchema,t))},exports.extendObject=function(e,t){return M(n({},e.objectSchema,t))},exports.extendStrictObject=function(e,t){return B(n({},e.objectSchema,t))},exports.lazy=function(e){var t,n,r,a=(t=e,r=!1,function(){if(r)return n;r=!0;for(var e=arguments.length,a=new Array(e),o=0;o<e;o++)a[o]=arguments[o];return n=t.apply(this,a)});return{type:function(){return"Lazy<"+a().type()+">"},map:function(){var e;return(e=a()).map.apply(e,arguments)},unmap:function(){var e;return(e=a()).unmap.apply(e,arguments)},validateBeforeMap:function(){var e;return(e=a()).validateBeforeMap.apply(e,arguments)},validateBeforeUnmap:function(){var e;return(e=a()).validateBeforeUnmap.apply(e,arguments)},mapXml:function(){var e;return(e=a()).mapXml.apply(e,arguments)},unmapXml:function(){var e;return(e=a()).unmapXml.apply(e,arguments)},validateBeforeMapXml:function(){var e;return(e=a()).validateBeforeMapXml.apply(e,arguments)}}},exports.literal=function(e){return f({type:"Literal<"+i(e)+">",validate:p((function(t){return e===t})),map:function(){return e}})},exports.nullable=function(e){return{type:function(){return"Nullable<"+e.type()+">"},validateBeforeMap:function(t,n){return null===t?[]:e.validateBeforeMap(t,n)},validateBeforeUnmap:function(t,n){return null===t?[]:e.validateBeforeUnmap(t,n)},map:function(t,n){return null===t?null:e.map(t,n)},unmap:function(t,n){return null===t?null:e.unmap(t,n)},validateBeforeMapXml:function(t,n){return null===t?[]:e.validateBeforeMapXml(t,n)},mapXml:function(t,n){return null===t?null:e.mapXml(t,n)},unmapXml:function(t,n){return null===t?null:e.unmapXml(t,n)}}},exports.number=function(){return f({type:"number",validate:p(m),map:c})},exports.numberEnum=function(e){var t=p(function(e){var t=Object.values(e);return function(e){return m(e)&&t.includes(c(e))}}(e));return f({type:"Enum<"+Object.values(e).filter((function(e){return"number"==typeof e})).join(",")+">",map:c,validate:t})},exports.object=M,exports.optional=function(e){return{type:function(){return"Optional<"+e.type()+">"},validateBeforeMap:function(t,n){return void 0===t?[]:e.validateBeforeMap(t,n)},validateBeforeUnmap:function(t,n){return void 0===t?[]:e.validateBeforeUnmap(t,n)},map:function(t,n){return void 0===t?void 0:e.map(t,n)},unmap:function(t,n){return void 0===t?void 0:e.unmap(t,n)},validateBeforeMapXml:function(t,n){return void 0===t?[]:e.validateBeforeMapXml(t,n)},mapXml:function(t,n){return void 0===t?void 0:e.mapXml(t,n)},unmapXml:function(t,n){return void 0===t?void 0:e.unmapXml(t,n)}}},exports.strictObject=B,exports.string=function(){return f({type:"string",validate:p(b),map:l})},exports.stringEnum=function(e){var t=p(function(e){var t=Object.values(e);return function(e){return"string"==typeof e&&t.includes(e)}}(e));return f({type:"Enum<"+Object.values(e).map(i).join(",")+">",map:l,validate:t})},exports.unknown=function(){return f({type:"unknown",validate:function(){return[]},map:l})},exports.validateAndMap=function(e,t){var n=s(y(e,t.type())),r=t.validateBeforeMap(e,n);return 0===r.length?{errors:!1,result:t.map(e,n)}:{errors:r}},exports.validateAndMapXml=function(e,t){var n=s(y(e,t.type())),r=t.validateBeforeMapXml(e,n);return 0===r.length?{errors:!1,result:t.mapXml(e,n)}:{errors:r}},exports.validateAndUnmap=function(e,t){var n=s(y(e,t.type())),r=t.validateBeforeUnmap(e,n);return 0===r.length?{errors:!1,result:t.unmap(e,n)}:{errors:r}},exports.validateAndUnmapXml=function(e,t){var n=s(y(e,t.type())),r=t.validateBeforeUnmap(e,n);return 0===r.length?{errors:!1,result:t.unmapXml(e,n)}:{errors:r}};
//# sourceMappingURL=schema.cjs.production.min.js.map
